
一、 目的
　　明确抗体自动化Gibson组装操作流程，确保操作人员可以参照该流程完成自动化数据生成，降低报错风险。
二、范围
　　适用于ACRO部门AI&AB相关自动化实验，本SOP适用于实验间数据处理和Tecan EVO 专用 worklist 的生成。
三、术语与定义
四、职责
4.1 实验员
　　负责严格执行本操作规程进行程序操作。
4.2项目负责人
　　负责监督程序执行，并对该标准操作规程（SOP）中技术参数的准确性、操作规范的正确性负责。
五、 程序部署
5.1 仪器设备
试剂（设备）名称
厂家（供货商）
规格（型号）


5.2试剂耗材 
物料名称
品牌
规格（型号）
准备数量

5.3 程序目录和界面
程序所在文件夹如下：
文件夹内含有配置文件文件夹config和主程序AntibodyToolbox.console.exe：
双击打开AntibodyToolbox.console.exe 进入程序主界面：
弹出两个界面，黑色界面为调试界面，用于查看报错信息；白色带按钮界面为操作主界面。
如要关闭整个程序，关闭调试界面即可。

5.3 程序功能一览（依据实验流程分类排序）：
1) 基因合成：
a) 翻译优化密码子&加同源臂
2) 引物浓度均一化：
a) 分离合成引物返样表
b) 根据片段浓度均一化
3) 转化涂板&挑单克隆：
a) 生成涂板&挑单克隆&送测的布局表
4) 菌液测序：
a) 将xlsx格式核酸序列转为fasta
b) 质粒测序结果自动比对
c) 替换正确的单克隆布局
5) 质粒和菌液cherrypick：
a) 转移&排序比对正确的样本菌液
b) 保存比对正确的返测质粒
6) 质粒浓度：
a) 根据Qbit计算96孔质粒的浓度
7) 转染表达：
a) 匹配重链质粒&轻链质粒并转染
8) 纯化和蛋白浓度：
a) 根据BCA计算抗体浓度并均一化
9) 其他功能：
a) 查询并高亮样本
b) 将xlsx的96*1数据转为布局表
c) 将序列翻译为氨基酸
d) 移动子目录所有文件到母目录

六、 工作程序
6.1 基因合成：
6.1.1 翻译优化密码子&加同源臂
①　 准备输入文件：
a) 准备1个输入文件。输入文件为xlsx格式，表头依次为 id, VH, VL，区分大小写。分别放置抗体名称，抗体重链氨基酸序列，抗体轻链氨基酸序列。

b) 抗体名称不应出现重复，抗体重链、轻链氨基酸序列可以重复。
②　 运行功能模块“翻译优化密码子&加同源臂”：
a) 点击相应按钮弹出如下窗口：

b) 点击“选择”按钮选择输入文件。
c) 在界面中勾选所需重链同源臂和轻链同源臂。程序可以根据氨基酸序列自动识别轻链同源臂应当添加kappa还是lambda，如果未识别成功，则按照人工选择的同源臂进行添加。
i. 注：若修改同源臂序列，程序会将新同源臂保存在配置文件中，并在下次使用时加载。
d) 在界面中选择密码子优化模式，根据实验中转染细胞是CHO或HEK293，选择相应选项。
e) 点击确定开始生成基因序列：
③　 输出文件：输入文件 xxx.xlsx 同目录下生成4个文件：
xxx_Synthesis.xlsx，xxx_Synthesis_check.xlsx，xxx_Pairs.xlsx，xxx_Multi.xlsx

a) xxx_Synthesis.xlsx：是用于制作基因合成订单的文件，其中：

i. “名称”为抗体重链（抗体原名称+“_H”）或轻链（抗体原名称+“_L”）名称，为后续实验样本的统一名称；
ii. “核苷酸序列”为抗体重链或轻链经过翻译、密码子优化、添加同源臂的核苷酸序列，序列两端的小写字母部分为同源臂；
iii. “氨基酸序列”为抗体重链或轻链的氨基酸序列；
iv. “链型”标注了重链和轻链添加的同源臂类型，若程序未能识别到序列分类为kappa或lambda，则标记为unknown，需要确认是否添加了正确同源臂；
v. 输出文件中，所有样本按照“重链-轻链kappa-轻链lambda-轻链unknown”排列，每个部分按名称升序排序；
vi. 由于程序会将序列去重复，因此实际生成的基因序列总数可能会少于抗体总数×2。
b) xxx_Synthesis_check.xlsx：用于人工复核的文件：
c) xxx_Pairs.xlsx：为抗体-重链-轻链对应关系的文件：

i. 表头中，antibody为抗体名称，chain_H 和 chain_L 分别为此抗体的重链和轻链名称；
ii. 此文件用在后续“转染质粒”环节。
d) xxx_Multi.xlsx：为复用重链和轻链的统计文件：
i. 此文件用于统计复用的重链轻链及其复用次数，方便后续抽提备用质粒。

6.2 引物浓度均一化：
6.2.1 分离合成引物返样表
①　 此功能将引物合成的浓度表拆分为样本在96孔板上的布局表和浓度表。适用于如下输入文件：

a) xlsx格式，具有多个sheet；
b) 每个sheet中存在2个 8×12 形状的表格，其中一个表为样本在96孔板的布局，包含了样本名称；另一个表包含了每个样本的浓度，与布局表中一一对应。
②　 点击运行功能模块，“分离合成引物返样表”：
弹出文件选择窗口，选择输入文件，点击“确定”，即进行分离操作；弹出窗口，显示“子表提取完成”，即分离成功。
③　 输出文件：输入文件xxx.xlsx 同目录下生成多个文件：

a) 每个sheet生成一对布局表和浓度表：
i. 布局表命名：{sheet名}_plate_{输入文件名}.xlsx：

ii. 浓度表命名：{sheet名}_conc_{输入文件名}.xlsx：

6.2.2 根据片段浓度均一化
①　 此功能根据基因片段浓度，通过worklist将所有片段均一为同一浓度和体积。需要2个输入文件：样本布局表（.xlsx）、样本浓度表（.xlsx）：
样本布局表：首行和首列为96孔板的位置索引（行为A-H，列为1-12）：
样本浓度表：首行和首列为96孔板的位置索引，浓度与布局表上样本一一对应：
②　 点击运行功能模块“根据片段浓度均一化”：
a) 弹出窗口：

b) “样本布局”选择样本布局表，“反测浓度”选择样本浓度表；
c) 目标浓度窗口填入8，加水体积填入50（样本均一化为50 μl加水体积，8 ng/μl终浓度）；

d) 点击“确定”处理文件。
i. 若输入文件中出现重复样本，则会跳出如下报错提示，并列出重复的样本名称。此时应当查看原浓度表中是否存在问题：

ii. 若处理成功，则弹出以下提示：

③　 输入文件同目录下输出2个文件：

a) {输入文件名}_primer_conc.xlsx 为引物浓度总表：
表头依次包含了样本名称、片段浓度、稀释所需取用体积；
b) {输入文件名}_all.csv 为Tecan移液工作站所用worklist表：
c) {输入文件名}_all.xlsx为Hamilton移液工作站所用worklist表：
d) 注意，目前worklist表中不包含加水过程，加水过程由各程序中96通道执行。


6.3 转化涂板&挑单克隆
6.3.1 转化涂板&挑单克隆
①　 功能：根据片段布局表(.xlsx)，生成涂板16孔板上的布局表（.xlsx），和转化涂板后，按照每行顺序，每个样本挑选5个单克隆的96孔深孔板布局表（.xlsx），用作送测。
a) 输入文件：含有片段名称的96孔板布局表（.xlsx），如6.2.1功能拆分出的布局表：

②　 点击运行功能模块“生成涂板&挑单克隆&送测的布局表”：
a) 点击相应按钮，弹出窗口选择输入文件，点击确定后处理文件，弹出提示则处理完成。

③　 输出文件：输入文件同目录下生成文件夹（与输入文件同名），文件夹内有2个输出文件：


a) plates_16_cells.xlsx为涂板16孔板上的布局表：
1个输入文件含有1个96孔板的布局信息，至多生成plate1-plate6，6个16孔板的布局表；
b) plates_sequencing.xlsx 是从16孔板挑选单克隆后，96孔深孔板的布局表：
至多生成1-6，6个96孔深孔板的布局表，用于送测。

6.4 菌液测序
6.4.1 将xlsx格式核酸序列转为fasta
①　 此功能用于生成基因参考序列文件，可用于比对测序结果：
a) 输入文件：xlsx格式，可用6.1.1中生成的xxx_Synthesis.xlsx 文件：
或其他xlsx文件，只需含有“名称”、“核苷酸序列”两列即可；
②　 运行功能模块“将xlsx格式核酸序列转为fasta”：
a) 点击相应按钮，弹出窗口选择输入文件，点击确定，弹出提示即处理完毕：

③　 输出文件：在输入文件同目录下生成1个文件，为{输入文件名}_output.fasta，可用记事本打开：

6.4.2 质粒测序结果自动比对
①　 此功能将测序文件与基因参考序列比对，生成比对结果：需要1个输入文件和1个输入目录：
a) 基因参考序列文件（.fasta 或者 .ab1）：可使用6.4.1中生成的fasta文件：

b) 测序结果目录：目录下包含所有样本的测序文件（ .fasta 或 .ab1 或 .seq，只选择一种文件格式）。如果测序文件分散在目录下的多个子文件夹中，则参考 6.9.5 的“移动子目录所有文件到母目录”模块：
注：需要文件内样本名称为 {样本名}-{单克隆编号}-CMV-{其他字符}，若出现报错，可查看是否是样本名称问题。
②　 点击运行功能模块“质粒测序结果自动比对”：
a) 弹出第一个窗口，选择基因参考序列文件，点击打开：

b) 弹出第二个窗口，选择测序文件所在目录，点击选择文件夹：

c) 稍等片刻，若弹出提示，则比对完成：
提示中会统计，名称匹配且比对正确的测序文件数量、名称不匹配但比对正确的测序文件数量、未比对到任何参考序列的测序文件数量。
③　 输出文件：参考序列（.fasta）同目录下会生成以下5个文件：

a) matched_output_for_query.txt ：包含比对正确的样本名称，用于后续菌液质粒的cherrypick：

b) match_info.txt ：包含比对正确的样本具体的比对信息：

c) mismatch_info.csv ：序列正确但名称不正确的样本具体比对信息：
表头依次为：比对到的参考序列的片段名称、测序文件对应单克隆名称、比对至参考序列的起始位点、结尾位点、警告信息。

d) output_no_matches.txt ：未比对到任何参考序列的测序样本（单克隆）名称：

e) output_no_matches_all.txt ：完全没有正确单克隆的样本名称，用于后续补挑单克隆：

6.4.3 （可选）替换正确的单克隆布局
①　 功能：6.4.2的生成结果中，有序列正确但名称不正确的单克隆。此功能可根据6.4.2 生成的 mismatch_info.csv ，将 6.3.1 的单克隆96孔板布局表（.xlsx）中对应的样本替换为正确的名称。功能接收两种输入文件：
a) 第一种输入文件：一个含有单克隆样本名称和参考序列名称的(.csv)文件，如 mismatch_info.csv ：
需要前2列数据即可，Seq_name 为单克隆样本名称，False_template 为单克隆比对到的参考序列名称（注意区分）；
b) 第二种输入文件：单个或多个来自于6.3.1的单克隆96孔板布局表（.xlsx）：

②　 点击运行功能模块“替换正确的单克隆布局”：
a) 点击相应按钮，弹出选择（.csv）文件窗口，选择参考序列和单克隆匹配信息(.csv)文件并点击确定；
b) 弹出选择（.xlsx）文件窗口，可以多选或单选，选择96孔板布局(.xlsx)文件并点击确定；
c) 弹出提示，询问是否继续选择布局(.xlsx)文件，如果需要继续选择，点击“是”即可弹出选择（.xlsx）文件窗口继续选择当前目录或其他目录的布局(.xlsx)文件，点击“否”则进入数据处理阶段：

d) 弹出提示，则处理完成。提示中显示找到并替换的单克隆数量，和未找到的单克隆数量：

③　 输出文件：参考序列和单克隆匹配信息(.csv)文件同目录下生成2个txt文件，每个96孔板布局(.xlsx)文件同目录下都生成1个xlsx文件：

a) {输入.csv文件名}_found.txt ：查找到的单克隆样本被纠正后的新名称，用于后续质粒和菌液cherrypick，新名称为 {参考序列名称}-9 ：

b) {输入.csv文件名}_not_found.txt ：未在布局表中查找到的单克隆样本，应为空文件；
c) {输入.xlsx文件名}_modified.xlsx：纠正后的96孔板布局表，其中被替换新名称的单元格用浅蓝色标识，用于后续质粒和菌液cherrypick：

6.5 质粒和菌液cherrypick
6.5.1 转移&排序比对正确的样本菌液
①　 功能：根据比对结果，将测序正确的样本菌液转移到新的96孔板（cherry-H和cherry-L板）中。程序将重链单克隆分配在cherry-H板，轻链单克隆分配在cherry-L板；如果单克隆总数小于96个，则自动将所有单克隆分配在cherry-H板；需要2种输入文件：
a) 第一种输入文件：单个或多个来自于6.3.1或者6.4.3的单克隆96孔板布局表（.xlsx）：

b) 第二种输入文件：单个或多个含有需要挑选的单克隆样本名称的.txt文件，可来自于6.4.2的matched_output_for_query.txt 或者6.4.3的mismatch_info_found.txt：
每行1个单克隆名称的txt文件即可（需要名称完全一致，不能有空格）

②　 点击运行功能模块“转移&排序比对正确的样本菌液”：
a) 点击相应按钮，弹出选择96孔板布局表（.xlsx）窗口，可以多选或单选，选择96孔板布局(.xlsx)文件并点击确定；
b) 弹出提示，询问是否继续选择布局(.xlsx)文件，如果需要，点击“是”即可弹出选择（.xlsx）文件窗口继续选择当前目录或其他目录的布局(.xlsx)文件，点击“否”则进入下一步骤：

c) 弹出选择样本名称（.txt）文件窗口，可以多选或单选，选择样本名称（.txt）文件并点击确定；
d) 弹出提示，询问是否继续选择样本名称（.txt）文件，如果需要，点击“是”即可弹出选择样本名称（.txt）文件窗口继续选择当前目录或其他目录的样本名称（.txt）文件，点击“否”则开始数据处理：

e) 弹出完成提示，则处理完成。
③　 输出文件：第1个样本名称（.txt）文件同目录下生成3个.xlsx文件，每个布局(.xlsx)文件同目录下生成1个.xlsx文件：

a) plates.xlsx：单克隆cherrypick至新板的布局表，至多cherry-H、cherry-L各一板，用于后续质粒转染：

b) worklist.xlsx：用于移液工作站的cherrypick：
i. 所有样本按照cherry-H、cherry-L的Destination_position升序排列；
ii. Source_label 是对输入文件中96孔板（.xlsx）文件内的孔板重新按序编号，与工作站脚本中设置的96孔板编号一一对应（不超过12个）；
iii. Source_file 是 Source_label 孔板的原编号和源文件名称，记录为：
{孔板原编号}-{源目录名称}-{源文件名称}

c) check.xlsx：
i. 用于人工复核，内容与worklist.xlsx相同。

d) highlighted_{布局表文件名}.xlsx：布局表，将被cherrypick的孔以荧光黄标出，方便人工复核：

6.5.2 保存比对正确的返测质粒
①　 功能：根据比对结果，将测序正确的样本质粒转移到新的96孔板（cherry-H和cherry-L板）中。程序将重链单克隆分配在cherry-H板，轻链单克隆分配在cherry-L板；如果单克隆总数小于96个，则自动将所有单克隆分配在cherry-H板；可以选择是否将多个序列相同质粒集在同一孔中；需要2种输入文件，与6.5.1相同，参考6.5.1 ① 准备输入文件。
②　 点击运行功能模块“保存比对正确的返测质粒”
a) 弹出询问窗口，选择是否将多个序列相同质粒集在同一孔中（若选择否，则每组相同序列的质粒只会挑选1个做cherrypick）：

b) 其余操作与 6.5.1 ② a-e 相同，请参考操作。
③　 输出文件：与 6.5.1 ③ 相同，请参考查阅：
a) 若选择将多个序列相同质粒集在同一孔，人工复核时建议检查是否出现目标孔体积过量。

6.6 质粒浓度
6.6.1 根据Qbit计算96孔质粒的浓度
①　 功能：根据Qbit检测的酶标仪读数计算96孔板内质粒样本的浓度。需要2种输入文件：
a) 第一种输入文件：1个96孔板布局（.xlsx）文件，其中可含有多个sheet，包含1-2个孔板：

b) 第二种输入文件：单个或多个酶标仪读数文件（.asc），可用记事本打开：
只需要第1列为读数即可（默认按照96孔板上列优先排序）

②　 点击运行功能模块“根据Qbit计算96孔质粒的浓度”，弹出窗口：

a) 窗口中，“plate布局.xlsx”一栏，点击选择以选择96孔板布局（.xlsx）文件；
b) 标准曲线计算公式及公式参数默认提供如上。如需要校正，可修改参数，参数会保存并在下次调用功能时加载新参数；
c) 点击确定进入下一步骤，模块将读取96孔板布局（.xlsx）文件的每一个sheet，并弹出文件选择窗口，窗口右上角会显示当前sheet名称，选择相应读数（.asc）文件：

d) 选择完读数（.asc）文件后，模块开始处理数据，弹出提示窗口则处理完成。
③　 输出文件：96孔板布局（.xlsx）文件同目录下生成1个 conc.xlsx 文件，用作后续质粒转染：
a) Plasmid 为质粒名称，Qbit 为酶标仪读数，Adjusted concentration 为计算得到的质粒浓度（ng/μl），Volume 为根据后续转染量计算的取用体积（μl）。

6.7 转染表达
6.7.1 匹配重链质粒&轻链质粒并转染
①　 功能：根据重轻链质粒匹配关系、质粒浓度、96孔板布局，生成重轻链质粒转染关系表。需要3个输入文件：
a) 重轻链质粒匹配关系表（.xlsx）文件：可使用 6.1.1 中生成的 xxx_Pairs.xlsx 文件：
表头中，antibody为抗体名称，chain_H 和 chain_L 分别为此抗体的重链和轻链名称；

b) 质粒浓度（.xlsx）文件：可使用 6.6.1 中生成的conc.xlsx 文件：
Plasmid 为质粒名称，Qbit 为酶标仪读数，Adjusted concentration 为计算得到的质粒浓度（ng/μl），Volume 为根据转染量计算的取用体积（μl）。

c) 96孔板布局（.xlsx）文件：其中可含有多个sheet，包含1-2个孔板：

②　 运行功能模块“匹配重链质粒&轻链质粒并转染”，弹出窗口：
a) 布局表一栏选择96孔板布局（.xlsx）文件；浓度表一栏选择质粒浓度（.xlsx）文件；配对表一栏选择重轻链质粒匹配关系表（.xlsx）文件；
b) 点击确定开始处理数据，弹出提示则处理完成。

③　 输出文件：96孔板布局（.xlsx）文件同目录下生成4个文件：

a) transfer_worklists_and_check.xlsx：包含人工复核表 check_output，重链质粒cherrypick表H_worklist，轻链质粒cherrypick表L_worklist：
i. 人工复核表 check_output：
为H_worklist和L_worklist匹配拼接而成，另附Antibody_name列，标识每行重轻链组成的抗体名称；
b) plasmids_h_l_plate.xlsx：重轻链匹配转染至新96孔板后的布局，可能生成多个孔板，每个sheet对应1个96孔板：

c) cell_plates.xlsx：每个新96孔板会转染至4个24孔细胞培养板，此文件包含这些细胞培养板内抗体样本的布局：

d) highlited_plates.xlsx：与输入文件的96孔板布局（.xlsx）文件相同，其中被匹配和取用的质粒样本名称被高亮为黄色，方便人工复核：

6.8 纯化和蛋白浓度
6.8.1 根据BCA计算抗体浓度并均一化
①　 功能：根据酶标仪吸光度读数计算抗体浓度，输入文件与 6.6.1 要求相同。
②　 操作方法和注意事项可参考 6.6.1，区别为此功能目前支持单个吸光度读数（.asc）文件（可补充具体操作细节）；

③　 输出文件：96孔板布局（.xlsx）文件同目录下输出2个文件：
a) 1个浓度文件（.xlsx）可参考 6.6.1
b) 1个cherrypick文件（.xlsx）用作浓度均一化。

6.9 其他功能
6.9.1 查询并高亮样本
①　 功能：根据1个含有样本名称的txt文件（无表头，每行1个样本名），在1个96孔板布局（.xlsx）文件内查询并高亮查找到的样本。
②　 输出文件：96孔板布局（.xlsx）文件同目录下，生成highlighted_{布局文件名}.xlsx 文件，其中查询到的样本单元格被高亮标黄。

6.9.2 将xlsx的96*1数据转为布局表
①　 功能：将含有样本名称的xlsx文件（无表头，首列每行1个样本名）转换为1个96孔板布局（.xlsx）表
a) 转换方式为按照列优先的顺序（A-H）进行重排；
②　 输出文件：同目录下生成 {输入文件名}_output.xlsx 布局文件。

6.9.3 将序列翻译为氨基酸
①　 功能：将DNA序列翻译为氨基酸序列，接收1个序列（.xlsx）文件，无表头，第1列为样本名称，第2列为DNA序列；
②　 输出文件：无输出文件，直接在输入的序列（.xlsx）文件第3列填入翻译后的氨基酸序列。

6.9.4 移动子目录所有文件到母目录
③　 功能：将选择的目录下所有子文件夹内的文件，都移动至当前目录，并删除空的子文件夹；
④　 输出文件：无输出文件。

AI抗体数据处理工具标准操作规程
编号：

等级： 秘密




